{% load i18n wagtailadmin_tags %}

{% dialog id="w-unsaved-changes-dialog" icon_name="warning" icon_classname="w-text-critical-200" title=_("Refreshing the page means you will lose any unsaved changes") %}
    <div class="w-mt-8">
        <button class="button" type="button" data-controller="w-action" data-action="w-action#reload">{% trans "Refresh page" %}</button>
        <button class="button button-secondary" type="button" data-action="w-dialog#hide">{% trans "Cancel" %}</button>
    </div>
{% enddialog %}

{% blocktranslate trimmed with user_name=_("system") model_name=_("page") asvar someone_has_saved_message %}
    {{ user_name }} has saved a newer version of this {{ model_name }}
{% endblocktranslate %}

{% blocktranslate trimmed with user_name=_("system") asvar overwrite_message %}
    Proceeding will overwrite the changes made by {{ user_name }}. Refreshing the page will lose any of your unsaved changes.
{% endblocktranslate %}

{% dialog id="w-overwrite-changes-dialog" dialog_root_selector='[data-edit-form]' icon_name="warning" icon_classname="w-text-critical-200" title=someone_has_saved_message|capfirst subtitle=overwrite_message|capfirst %}
    <div class="w-mt-8">
        <button class="button" type="button" data-action="w-dialog#confirm">{% trans "Continue" %}</button>
        <button class="button button-secondary" type="button" data-controller="w-action" data-action="w-action#reload">{% trans "Refresh the page" %}</button>
    </div>
{% enddialog %}

<form
    id="w-editing-sessions"
    method="post"
    data-controller="w-action w-session"
    data-w-action-continue-value="true"
    data-w-action-url-value="{{ release_url }}"
    data-w-session-w-dialog-outlet="[data-edit-form] [data-controller='w-dialog']#w-overwrite-changes-dialog"
    data-action="visibilitychange@document->w-session#dispatchVisibilityState w-session:visible->w-session#ping w-session:visible->w-session#addInterval w-session:hidden->w-session#clearInterval w-session:hidden->w-action#sendBeacon"
>
    {% include "wagtailadmin/shared/editing_sessions/list.html" with sessions=sessions only %}
</form>
